---
- name: Simulate IOS Upgrade on Cisco Routers
  hosts: all
  gather_facts: no
  connection: network_cli

  tasks:

  - name: Backup Running Configuration
    ios_config:
      backup: yes
    register: backup_result

  - name: Display Backup Path
    debug:
      msg: "Backup saved at {{ backup_result.backup_path }}"

  - name: Show Flash to Check Existing Image
    ios_command:
      commands: "dir flash:"
    register: flash_output

  - name: Print Flash Contents
    debug:
      var: flash_output.stdout_lines

  - name: Simulate Copying IOS Image (No Real SCP)
    debug:
      msg: "Simulated: Copy IOS from SCP to flash. Skipping real transfer."

  - name: Set Boot Variable (Simulated Image)
    ios_config:
      lines:
        - boot system flash:c1900-universalk9-mz.SPA.155-3.M4.bin

  - name: Save Configuration
    ios_config:
      save_when: modified

  - name: Simulate Reload (Skipping actual reload)
    debug:
      msg: "Simulated: Reload command issued. Device would reboot here."
